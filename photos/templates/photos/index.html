{% load static %}

<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="{% static 'photos/styles/base.css' %}">
    <script defer src="{% static 'photos/scripts/my-script.js' %}">
    </script>
    <title>Photo gallery</title>
</head>
<body>
<form action="{% url 'options' %}" method="get" id="myForm">
    <div class="sidenav">
        <a href="{% url 'main'%}">Home</a>
            <button type="button" class="dropdown-btn">
                Sort by
            </button>
            <div class="dropdown-container">
                <div onClick="submitForm('sort_atoz')">
                    {% with "sort_atoz" as val %}
                        <input id="sort_atoz" name="sort_atoz" type="checkbox" value="enabled" {% if val in isChecked %} checked {% endif %}/>
                    {% endwith %}
                    <label for="sort_atoz">A to Z</label>
                </div>

                <div onClick="submitForm('sort_film')">
                    {% with "sort_film" as val %}
                        <input id="sort_film" name="sort_film" type="checkbox" value="enabled" {% if val in isChecked %} checked {% endif %}/>
                    {% endwith %}
                    <label for="sort_film">Film</label>
                </div>

                <div onClick="submitForm('sort_date')">
                    {% with "sort_date" as val %}
                        <input id="sort_date" name="sort_date" type="checkbox" value="enabled" {% if val in isChecked %} checked {% endif %}/>
                    {% endwith %}
                    <label for="sort_date">Date taken</label>
                </div>

                <div onClick="submitForm('sort_camera')">
                    {% with "sort_camera" as val %}
                        <input id="sort_camera" name="sort_camera" type="checkbox" value="enabled" {% if val in isChecked %} checked {% endif %}/>
                    {% endwith %}
                    <label for="sort_camera">Camera</label>
                </div>
            </div>


            <button type="button" class="dropdown-btn">
                Camera
            </button>
            <div class="dropdown-container">
                {% for x in cameras %}
                    <div>
                        {% with x.id|stringformat:"i" as t %}
                            {% with "camera_"|add:t as val %}
                            <input onClick="submitForm('camera_'+{{ x.id }})" id="camera_{{ x.id }}" name="camera_{{ x.id }}" type="checkbox" value="enabled" {% if val in isChecked %} checked {% endif %}/>
                            {% endwith %}
                        {% endwith %}
                        <label onClick="submitForm('camera_'+{{ x.id }})" for="camera_{{ x.id }}">{{x.model}}</label>
                    </div>
                {% endfor %}
            </div>


            <button type="button" class="dropdown-btn">
                Film
            </button>
            <div class="dropdown-container">
                {% for x in film %}
                    <div onClick="submitForm('film_'+{{ x.id }})">
                        {% with x.id|stringformat:"i" as t %}
                            {% with "film_"|add:t as val %}
                            <input id="film_{{ x.id }}" name="film_{{ x.id }}" type="checkbox" value="enabled" {% if val in isChecked %} checked {% endif %}/>
                            {% endwith %}
                        {% endwith %}
                        <label for="film_{{ x.id }}">{{x.name}}</label>
                    </div>
                {% endfor %}
            </div>


            <button type="button" class="dropdown-btn">
                Event
            </button>
            <div class="dropdown-container">
                {% for x in event %}
                    <div onClick="submitForm('event_'+{{ x.id }})">
                        {% with x.id|stringformat:"i" as t %}
                            {% with "event_"|add:t as val %}
                            <input id="event_{{ x.id }}" name="event_{{ x.id }}" type="checkbox" value="enabled" {% if val in isChecked %} checked {% endif %}/>
                            {% endwith %}
                        {% endwith %}
                        <label for="event_{{ x.id }}">{{x.name}}</label>
                    </div>
                {% endfor %}
            </div>

        <a class="upload-btn" id="myBtn">Upload</a>
    </div>

    <div class="main">
        {% for x in photos %}
            <div class="responsive">
                <button class="select-btn" id="photo_{{ x.id }}" name="photo_{{ x.id }}" type="submit" value="show">
                <div class="gallery">
                    <img src="{% static 'photos/pictures/' %}{{ x.fileName }}">
                    <div class="desc">{{x.fileName}}</div>
                </div>
                </button>
            </div>
        {% endfor %}
    </div>
</form>

<form method="post" id="modal-form" enctype="multipart/form-data">
    {% csrf_token %}

    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close-upload">&times;</span>
            <img class="modal-img" src="">
            <table class="modal-info">
                <tr>
                    <th>Filename: </th>
                    <td id="add-new-filename" contenteditable="true">{{sPhoto.fileName}}</td>
                    <input id="add-filename" name="filename" type="hidden"/>
                </tr>
                <tr>
                    <th>Camera: </th>
                    <td>
                        <select name="camera">
                            {% for x in cameras %}
                            <option value="{{x.id}}">{{x.model}}</option>
                            {% endfor %}
                            <option value="none" selected>none</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Event: </th>
                    <td>
                        <select name="event">
                            {% for x in event %}
                            <option value="{{x.id}}">{{x.name}}</option>
                            {% endfor %}
                            <option value="none" selected>none</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Film: </th>
                    <td>
                        <select name="film">
                            {% for x in film %}
                            <option value="{{x.id}}">{{x.name}}</option>
                            {% endfor %}
                            <option value="none" selected>none</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Time Stamp: </th>
                    <td>
                        <input id="add-timestamp" name="timestamp" type="datetime-local" value="{{sPhoto.timestamp}}{% if sPhoto.film_id %}T00:00{% endif %}" />
                    </td>
                </tr>
                <tr>
                    <th>FilmEnd: </th>
                    <td>
                        <input id="add-filmEnd" name="filmEnd" type="datetime-local" value="{{sPhoto.filmEnd}}{% if sPhoto.film_id %}T00:00{% endif %}" />
                    </td>
                </tr>
                <tr>
                    <label for="img">Select image:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </tr>
            </table>
            <button class="modal-btn" id="add" name="add" onclick="submitModalForm('add')" type="submit" value="add">Add to database</button>
        </div>
    </div>

    {% if sPhoto %}
        <div id="imgModal" class="modal">
            <div class="modal-content">
                <span class="close-photo">&times;</span>
                <img class="modal-img" src="{% static 'photos/pictures/' %}{{ sPhoto.fileName }}">
                <table class="modal-info">
                    <tr>
                        <th>Filename: </th>
                        <td id="new-filename" contenteditable="true">{{sPhoto.fileName}}</td>
                        <input id="filename" name="filename" type="hidden"/>
                    </tr>
                    <tr>
                        <th>Camera: </th>
                        <td>
                            <select name="camera">
                                {% for x in cameras %}
                                <option value="{{x.id}}" {% if x.id == sPhoto.camera_id %} selected {% endif %}>{{x.model}}</option>
                                {% endfor %}
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <th>Event: </th>
                        <td>
                            <select name="event">
                                {% for x in event %}
                                <option value="{{x.id}}" {% if x.id == sPhoto.event_id %} selected {% endif %}>{{x.name}}</option>
                                {% endfor %}
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <th>Film: </th>
                        <td>
                            <select name="film">
                                {% for x in film %}
                                <option value="{{x.id}}" {% if x.id == sPhoto.film_id %} selected {% endif %}>{{x.name}}</option>
                                {% endfor %}
                                <option value="{{x.id}}"{% if not sPhoto.film_id %} selected {% endif %}>none</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <th>Time Stamp: </th>
                        <td>
                            <input id="timestamp" name="timestamp" type="datetime-local" value="{{sPhoto.timestamp}}{% if sPhoto.film_id %}T00:00{% endif %}" />
                        </td>
                    </tr>
                    <tr>
                        <th>FilmEnd: </th>
                        <td>
                            <input id="filmEnd" name="filmEnd" type="datetime-local" value="{{sPhoto.filmEnd}}{% if sPhoto.film_id %}T00:00{% endif %}" />
                        </td>
                    </tr>
                </table>
                <button class="modal-btn" id="save" onclick="submitModalForm('save')" name="save" type="submit" value="{{sPhoto.id}}">Save</button>
                <button class="modal-btn" id="delete" onclick="submitModalForm('delete')" name="delete" type="submit" value="{{sPhoto.id}}">Delete</button>
            </div>
        </div>
    {% endif %}
</form>
</body>
</html>